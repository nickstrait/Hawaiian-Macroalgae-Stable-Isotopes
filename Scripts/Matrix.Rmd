```{r}
library(dplyr)
library(vegan)
```



```{r}
## N15 matrix
N15.matrix <- tapply(nitrogen_data$N15,
              INDEX = list(nitrogen_data$ID, nitrogen_data$Genus),
              mean)

N15.matrix <- ifelse(is.na(N15.matrix), 0, N15.matrix)
N15.matrix[1:5, 1:5]
```

```{r}
## percent N martix
percent.matrix <- tapply(nitrogen_data$Percent,
              INDEX = list(nitrogen_data$ID, nitrogen_data$Genus),
              mean)
percent.matrix <- ifelse(is.na(percent.matrix), 0, percent.matrix)
percent.matrix[1:5, 1:5]
```

```{r}
cols_to_keep = c('Depth', 'Location', 'Region', 'Zone', 'Division')
factors.matrix = aggregate(nitrogen_data[ ,cols_to_keep], by = list(nitrogen_data$ID), function(x) x[1])
row.names(factors.matrix) = factors.matrix[ , 1]
factors.matrix = factors.matrix[ , -1]
head(factors.matrix)
```
